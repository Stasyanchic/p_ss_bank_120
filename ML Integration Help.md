# AI/ML Integration Help

## Содержание
- [Описание задачи](#описание-задачи)
- [Функциональные возможности](#функциональные-возможности)
- [Архитектура](#архитектура)
  - [Источники данных](#источники-данных)
  - [Модель аномалий](#модель-аномалий)
  - [Визуализация результатов](#визуализация-результатов)
  - [Алёрты и уведомления](#алёрты-и-уведомления)
- [Технологический стек](#технологический-стек)
- [Минимальный MVP](#минимальный-mvp)
- [Развертывание](#развертывание)
- [Дополнительные требования](#дополнительные-требования)

---

## Описание задачи
**Цель:** интегрировать в проект базовый механизм ИИ/машинного обучения для автоматического анализа логов и метрик, с последующим обнаружением аномалий.  
Это позволит заранее выявлять отклонения в поведении приложения и минимизировать риски сбоев.

---

## Функциональные возможности
- Сбор метрик через Prometheus и логов через Loki.
- Анализ данных с помощью модели аномалий.
- Отображение обнаруженных отклонений в Grafana.
- Отправка уведомлений о найденных аномалиях через Alertmanager.

---

## Архитектура

### Источники данных
- **Prometheus** — сбор метрик CPU, памяти, состояния подов.
- **Loki** — сбор логов приложений (опционально).
- Агенты: **Prometheus Node Exporter**, **Fluentd/Fluentbit**.

### Модель аномалий
- Модель: **Isolation Forest** или **One-Class SVM**.
- Альтернативно — использование **Grafana Machine Learning Plugin** без написания кода.
- Модель обучается на нормальных данных и выделяет аномалии.

### Визуализация результатов
- Отображение аномалий в Grafana через:
  - Панели с графиками и пометками аномалий.
  - Аннотации на временных рядах.
  - Отдельные алерт-панели.

### Алёрты и уведомления
- Интеграция с **Alertmanager**.
- Настройка уведомлений в Telegram, Slack или Email по срабатыванию аномалии.

---

## Технологический стек
- Python 3.11 / Scikit-learn (при использовании собственной модели).
- Prometheus
- Grafana 10+
- Loki (опционально)
- Kubernetes 1.25+
- Docker
- Grafana Machine Learning Plugin (если без самостоятельной модели)

---

## Минимальный MVP
- Сбор метрик CPU через Prometheus API.
- Обучение модели Isolation Forest.
- Предсказание аномалий.
- Отображение аномалий через аннотации в Grafana.

---

## Развертывание
- Модель разворачивается в Kubernetes отдельным `Deployment`.
- Доступ к данным Prometheus через сервис Discovery.
- Интеграция результатов в Grafana через HTTP API.

---

## Дополнительные требования
- Модуль ИИ должен работать независимо и не влиять на основное приложение.
- Все обмены данными должны происходить внутри Kubernetes-кластера.
- Логи модели должны выводиться в stdout/stderr для сбора через стандартные лог-системы.
- При обнаружении аномалии должна сохраняться запись о событии для аудита.

---
